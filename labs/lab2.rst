Работа в командной строке Linux
#################################

:date: 2018-09-22 15:30
:summary: lab2
:status: published


.. default-role:: code

Работа в командной строке Linux
========

Kомандный интерпретатор (или командная оболочка) – это программа, принимающая и выполняющая программы. Командный интерпретатор также поддерживает конструкции программирования, позволяя составлять сложные команды из более простых.
Мы рассмотрим командный интерпретатор bash – это один из интерпретаторов, доступных в Linux.

Команды в ОС Linux состоят из названия команды, опций и параметров.

.. code-block:: bash

	[user@comp ~]$ command_name [options] [params]
	
Рассмотрим этот синтаксис на примере некоторых распространенных команд.
	
ls
----

Выводит в консоль содержимое одной или нескольких папок. Без параметров команда команда возвращает содержимое текущей папки. Откройте терминал и попробуйте

.. code-block:: bash

	[user@comp ~]$ ls
	
В качестве параметров подаются пути к папкам, содержимое которых нужно напечатать. Выполните, пожалуйста, приведенные ниже команды. (В bash то, что следует после символа '#', является комментарием и не выполняется.)

.. code-block:: bash

	[user@comp ~]$ ls /  # содержимое корневого каталога (/ - корневой каталог в linux)
	[user@comp ~]$ ls / /home  # аргументы и опции разделяются одним или более пробелами (/home директория с личными папками пользователей)
	[user@comp ~]$ ls <some_dir_in_current_directory>  # команде ls в качестве параметров можно передаввать, как абсолютные (начинаются с / или ~) пути, так и относительные (пути из текущей директории)
	[user@comp ~]$ ls ~  # ~ - краткое название домашней папки текущего пользователя (/home/my_name)
	
Опции можно указывать до, после и между параметрами, но принято их писать до параметров. Порядок опций не важен в bash. У опции могут быть короткий и длинный варианты записи, или оба варианта. Короткая запись состоит из дефиса и одной буквы латинского алфавита. Например

.. code-block:: bash

	[user@comp ~]$ ls -l  # вместе с названиями файлов и папок печатаются их метаданные
	[user@comp ~]$ ls -a  # печатаются все файлы, включая скрытые (в linux файлы с именами, начинающимися с '.', являются скрытыми)
	[user@comp ~]$ ls -l -a  # опции разделяются пробелами (порядок опций не важен)
	[user@comp ~]$ ls -al  # короткие опции можно объединять
	
Длинная запись опции начинается с двух дефисов. Например


.. code-block:: bash

	[user@comp ~]$ ls --all  # то же самое, что и -a
	
man
----

``man [command_name]`` покажет документацию по команде ``command_name``. Пример:

.. code-block:: bash

	[user@comp ~]$ man ls
	
touch
------
  
Команда ``touch`` меняет время последнего изменения файлов и папок. Если файл не существует, то создается пустой файл с соответствующим именем. Если время не указано, устанавливается текущее время.

.. code-block:: bash

	[user@comp ~]$ touch new_file  # создается пустой файл (если его не было раньше)
	[user@comp ~]$ touch "name with spaces"  # если в пути к файлу или папке есть пробелы, то путь следует заключать в кавычки"
	
Опции могут использоваться для передачи аргументов. Например, команде ``touch`` можно передать дату последнего изменения, которую требуется установить. Возможны с разные варианты синтаксиса при передаче аргумента через опцию. Попробуйте.


.. code-block:: bash

	[user@comp ~]$ touch --date="jan 1 2000" new_file  
	[user@comp ~]$ ls -l
	[user@comp ~]$ touch --date "jan 1 1000" new_file 
	[user@comp ~]$ ls -l
	[user@comp ~]$ touch -d "jan 1 500" new_file
	[user@comp ~]$ ls -l
	
mkdir
-----

Используется для создания директорий.

.. code-block:: bash

	[user@comp ~]$ mkdir new_dir
	
rm
----

Предназначена для удаления файлов и каталогов.

.. code-block:: bash

	[user@comp ~]$ rm new_file "name with spaces"
	[user@comp ~]$ rm -R new_dir  # при удалении каталога следует указать ключ -R (recursive)
	
cd
----

Переход между директориями. ``cd [path]``

Попробуйте

.. code-block:: bash

	[user@comp ~]$ mkdir -p dir1/dir2/dir3  # ключ -p (--parents) позволяет создавать каталоги рекурсивно
	[user@comp ~]$ cd dir1
	[user@comp ~]$ cd dir2/dir3  # так переходим по относительному пути
	[user@comp ~]$ cd ~/dir1/dir2  
	[user@comp ~]$ cd /  # последние 2 раза по абсолютному пути
	[user@comp ~]$ cd  # без аргументов команда вернет нас в домашний каталог
	[user@comp ~]$ mkdir dir4  # создадим еще одну папку
	[user@comp ~]$ cd dir4
	[user@comp ~]$ cd ../dir1/dir2  # в bash ".." - папка на один уровень выше, а "." - текущая папка
	[user@comp ~]$ cd
	
mv
----

Перемещение и переименование файлов и папок.

.. code-block:: bash

	[user@comp ~]$ cd;ls
	[user@comp ~]$ mv dir1 dir5;ls  # переименовать папку dir1, если записать несколько команд, разделив их ``;``, то они выполнятся последовательно
	[user@comp ~]$ mv dir5 dir4;ls dir4  # переместить папку dir5, т. к. dir4 уже существует

Команда ``mv`` применяется одинаково к файлам и папкам.

cp
----

Копирование. С ключом ``-r`` или ``-R`` можно копировать папки.

.. code-block:: bash

	[user@comp ~]$ touch my_file;ls
	[user@comp ~]$ cp my_file my_file2;ls  # скопировать файл
	[user@comp ~]$ cp -r dir4 dir5;ls  # скопировать папку
	[user@comp ~]$ cp my_file dir5;ls dir5  # скопировать файл my_file в dir5, т. к. существует папка dir5
	
wildcards
----

Если требуется передать команде несколько параметров можно использовать подстановки. Подробное описание подстановок можно получить с помощью команды ``man 7 glob``. Здесь мы рассмотрим только звездочку ``*``. Если в параметре ``P`` есть ``*`` то этот параметр будет заменен на список имен **существующих** файлов и папок, которые получаются из параметра ``P`` заменой ``*`` произвольной строкой, не содежащей символа ``/``. Другими словами параметр со ``*`` используется как шаблон, с которым сравниваются имена файлов и папок. Пример:

.. code-block:: bash

	[user@comp ~]$ ls dir*  # вывести на экран содержимое вех папок, имена которых начинаются с dir
	[user@comp ~]$ ls dir*/dir*  
	[user@comp ~]$ mv my_file* dir4  # скопировать все файлы, имена которых начинаются с my_file в папку dir4
	[user@comp ~]$ rm -r my_file* dir4 dir5

	
Настройка и некоторые возможности git
========

git - распределенная система контроля версий, используемая главным образом для управления исходным кодом. Она позволяет переключаться между версиями кода, объединять их, записывать изменения в коде на сервер и обновлять локальные копии файлов в соответствии с их копиями на сервере. Для хранения удаленной версии кода мы будем использовать github. 

1. Зарегистрируйтесь на github.com с помощью почты, на которую пришло приглашение в организацию группы
2. Вступите в организацию
3. Перейдите к созданию репозитория на github с помощью кнопки **New**
4. Назовите репозиторий по своим имени и фамилии. Их может разделять дефис (например peganov-anton-py).
5. Поставьте галочку в пункте **Initialize this repository with a README**
6. Нажмите кнопку **Clone or download** и скопируйте ссылку с помощью кнопки

.. image:: {filename}/images/clone_repo.jpeg

7. Откройте терминал, перейдите в домашний каталог и выполните команду

.. code-block:: bash

	[user@comp ~]$ git clone <copied_path>  
	
8. Создайте папку lab2 и перейдите в нее

.. code-block:: bash

	[user@comp ~]$ mkdir lab2;cd lab2
	
9. Создайте скрипт hello_world.py с помощью gedit

.. code-block:: bash

	[user@comp ~]$ gedit hello_world.py  # gedit встроенный текстовый редактор
	
.. code-block:: python

	print("Hello world!")
	
10. Сохраните изменения и закройте редактор. Теперь запишем изменения в локальном репозитории на сервер. Изменения в репозиторий вносятся с помощью коммитов. Прежде всего необходимо указать, какие файлы будут входить в коммит. 

.. code-block:: bash

	[user@comp ~]$ git status  # Команда выведет список измененных и не отслеживаемых файлов
	
Видим, что наш скрипт пока не отслеживается git.


.. code-block:: bash

	[user@comp ~]$ git add hello_world.py  # теперь hello_world.py в очереди на коммит
	[user@comp ~]$ git status
	
11. Создайте коммит

.. code-block:: bash

	[user@comp ~]$ git commit -m "new: create hello_world.py"
	
Ключ ``-m`` позволяет сразу укказать сообщение коммита. В сообщении коммита указывается, что делает данный коммит. Если не использовать опцию ``-m``, откроется текстовый редактор, где удобно описать внесенные изменения более подробно. Коммиты без сообщений не принимаются.

.. code-block:: bash

	[user@comp ~]$ git status  # hello_world.py исчез из списков 

12. Запишите изменения на сервер

.. code-block:: bash

	[user@comp ~]$ git push  # надо ввести логин и пароль
	
13. Пусть Ваш коллега внес изменения в удаленный репозиторий или Вы сделали коммит на одном устройстве, а затем решили продолжить на другом. В этом случае требуется обновить локальный репозиторий. 


.. code-block:: bash

	[user@comp ~]$ git pull
	
Основы git хорошо изложены `здесь <https://git-scm.com/book/ru/v1>`_.
Про установку git в разных ОС `тут <https://git-scm.com/book/ru/v1/%D0%92%D0%B2%D0%B5%D0%B4%D0%B5%D0%BD%D0%B8%D0%B5-%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0-Git>`_.

jupyter
========

Интерактивное окружение, позволяющее создавать "ноутбуки". "Ноутбуки" могут содержать разнородные элементы, такие как исполняемый код, текст, изображения. Засчет этих возможностей их удобно использовать для анализа и визуализации данных, различных исследовательских, а также образовательных целей.


.. code-block:: bash

	[user@comp ~]$ cd ~/<repo_name>  # перейдите в ваш репозиторий
	[user@comp ~]$ jupyter notebook
	
Кликните на папку lab2, а затем на кнопку **New** и выберете *Python 3*. Переименуйте ноутбук в test2.
После решения теста сохраните результат на github

.. code-block:: bash

	[user@comp ~]$ git add test2.ipynb;git commit -m "test2";git push

Скачивание файла с уроком
========================

.. code-block:: bash

	[user@comp ~]$ cd ~/<your-repo-name>/lab2
	[user@comp ~]$ wget https://raw.githubusercontent.com/mipt-cs/python-biocad/master/lab2.ipynb
	[user@comp ~]$ git add lab2.ipynb;git commit -m "create lab2"
	
После занятия не забудте запушить то, что  сделали.
